% Plot and move the cube
function plot_move(self, state, move)

clf;
clear h;

% Define the cube elements in 2D and in 3D
F3d = define_faces_3d();
F2d = define_faces_2d();

% Color map
col = color_map();

%%%%%%%%%%%%%%%%%%%%%% Plot and move the cube in 2D %%%%%%%%%%%%%%%%%%%%%%%

subplot(2,1,2);
hold on;
axis equal;
set(gca,'xtick',[]);
set(gca,'ytick',[]);
xlim([-1 25]);
ylim([-1 19]);
% Update the state for next plot
new_state = self.update_state(state, move);

% Fill faces colors
for i = 1:54
    fill(F2d(1,:,i), F2d(2,:,i), cell2mat(col(1+new_state(i))), 'LineWidth', 1);
end

%%%%%%%%%%%%%%%%%%%%%% Plot and rotate the cube in 3D %%%%%%%%%%%%%%%%%%%%%

subplot(2,1,1);
hold on;
view(150,30);
axis equal;
set(gca,'xtick',[]);
set(gca,'ytick',[]);
set(gca,'ztick',[]);
xlim(5*[-1 1]);
ylim(5*[-1 1]);
zlim(5*[-1 1]);

frames = 4;
h = [];
for th = (pi/2)/frames:(pi/2)/frames:pi/2
    
    delete(h);
    
    % Apply rotation
    [rot_F3d, black_face] = rotation(F3d, move, th);
    
    % Fill internal face
    h(200) = fill3(squeeze(F3d(black_face,1,:)), squeeze(F3d(black_face,2,:)), squeeze(F3d(black_face,3,:)), 'k', 'LineWidth', 1);
    
    % Fill faces with colors
    for i = 1:54
        h(i) = fill3(squeeze(rot_F3d(i,1,:)), squeeze(rot_F3d(i,2,:)), squeeze(rot_F3d(i,3,:)), cell2mat(col(1+state(i))), 'LineWidth', 1);
    end
    
    % Fill internal faces with colors
    for j = [101,102,103,104,107,108,109,110,111,112,113,114,117,118,119,120,121,122,123,124,127,128,129,130]
        h(j) = fill3(squeeze(rot_F3d(j,1,:)), squeeze(rot_F3d(j,2,:)), squeeze(rot_F3d(j,3,:)), 'k', 'LineWidth', 1); 
    end
    
    pause(0.0001);
      
end

end

%==== Functions ===========================================================

% Apply rotation
function [faces, central_face] = rotation(faces, move, theta)

% Define rotation
switch move
    case "F"
        rot_faces = [13,14,15,25,26,27,37,38,39,7,8,9,16,28,40,12,24,36,46,47,48,101,102,103,104,111,112,117,118,121,127,128,122];
        R = [1 0           0         ;
            0 cos(theta) -sin(theta);
            0 sin(theta)  cos(theta)];
        central_face = 105;
    case "f"
        rot_faces = [13,14,15,25,26,27,37,38,39,7,8,9,16,28,40,12,24,36,46,47,48,101,102,103,104,111,112,117,118,121,127,128,122];
        R = [1 0            0          ;
            0 cos(-theta) -sin(-theta);
            0 sin(-theta)  cos(-theta)];
        central_face = 105;
    case "R"
        rot_faces = [16,17,18,28,29,30,40,41,42,3,6,9,15,27,39,19,31,43,48,51,54,111,112,113,114,101,102,108,107,121,127,130,124];
        R = [ cos(theta) 0 sin(theta);
            0          1 0         ;
            -sin(theta) 0 cos(theta)];
        central_face = 115;
    case "r"
        rot_faces = [16,17,18,28,29,30,40,41,42,3,6,9,15,27,39,19,31,43,48,51,54,111,112,113,114,101,102,108,107,121,127,130,124];
        R = [ cos(-theta) 0 sin(-theta);
            0           1 0          ;
            -sin(-theta) 0 cos(-theta)];
       central_face = 115;
    case "U"
        rot_faces = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,121,122,123,124,111,117,120,107,101,104,110,114];
        R = [cos(theta) -sin(theta) 0;
            sin(theta)  cos(theta) 0;
            0           0          1];
        central_face = 125;
    case "u"
        rot_faces = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,121,122,123,124,111,117,120,107,101,104,110,114];
        R = [cos(-theta) -sin(-theta) 0;
            sin(-theta)  cos(-theta) 0;
            0            0           1];
        central_face = 125;
    case "B"
        rot_faces = [19,20,21,31,32,33,43,44,45,1,2,3,18,30,42,52,53,54,10,22,34,107,108,109,110,123,124,129,130,113,114,119,120];
        R = [1 0            0          ;
            0 cos(-theta) -sin(-theta);
            0 sin(-theta)  cos(-theta)];
        central_face = 106;
    case "b"
        rot_faces = [19,20,21,31,32,33,43,44,45,1,2,3,18,30,42,52,53,54,10,22,34,107,108,109,110,123,124,129,130,113,114,119,120];
        R = [1 0           0         ;
            0 cos(theta) -sin(theta);
            0 sin(theta)  cos(theta)];
        central_face = 106;
    case "L"
        rot_faces = [10,11,12,22,23,24,34,35,36,1,4,7,13,25,37,46,49,52,21,33,45,104,122,117,118,103,128,110,120,123,109,119,129];
        R = [ cos(-theta) 0 sin(-theta);
            0           1 0          ;
            -sin(-theta) 0 cos(-theta)];
        central_face = 116;
    case "l"
        rot_faces = [10,11,12,22,23,24,34,35,36,1,4,7,13,25,37,46,49,52,21,33,45,104,122,117,118,103,128,110,120,123,109,119,129];
        R = [ cos(theta) 0 sin(theta);
            0          1 0         ;
            -sin(theta) 0 cos(theta)];
        central_face = 116;
    case "D"
        rot_faces = [46,47,48,49,50,51,52,53,54,34,35,36,37,38,39,40,41,42,43,44,45,102,112,127,103,118,128,109,119,129,108,113,130];
        R = [cos(-theta) -sin(-theta) 0;
            sin(-theta)  cos(-theta) 0;
            0            0           1];
        central_face = 126;
    case "d"
        rot_faces = [46,47,48,49,50,51,52,53,54,34,35,36,37,38,39,40,41,42,43,44,45,102,112,127,103,118,128,109,119,129,108,113,130];
        R = [cos(theta) -sin(theta) 0;
            sin(theta)  cos(theta) 0;
            0           0          1];
        central_face = 126;
end

% Rotate
for rt = rot_faces
    for i = 1:4
        faces(rt,:,i) = faces(rt,:,i)*R;
    end
end

end

% Define the coordinates of the faces in 3D
function faces = define_faces_3d()

faces = NaN(1,3,4);

% Groups of verteces of white (U) face

faces(1,:,:)  = [[-1,-3, 3]' , [-1,-1, 3]' , [-3,-1, 3]' , [-3,-3, 3]' ];
faces(2,:,:)  = [[-1, 1, 3]' , [-1,-1, 3]' , [-3,-1, 3]' , [-3, 1, 3]' ];
faces(3,:,:)  = [[-1, 3, 3]' , [-1, 1, 3]' , [-3, 1, 3]' , [-3, 3, 3]' ];

faces(4,:,:)  = [[1,-3, 3]'  , [ 1,-1, 3]' , [-1,-1, 3]' , [-1,-3, 3]' ];
faces(5,:,:)  = [[-1,-1, 3]' , [ 1,-1, 3]' , [ 1, 1, 3]' , [-1, 1, 3]' ];
faces(6,:,:)  = [[-1, 3, 3]' , [-1, 1, 3]' , [ 1, 1, 3]' , [ 1, 3, 3]' ];

faces(7,:,:)  = [[ 3,-3, 3]' , [ 3,-1, 3]' , [ 1,-1, 3]' , [ 1,-3, 3]' ];
faces(8,:,:)  = [[ 1,-1, 3]' , [ 3,-1, 3]' , [ 3, 1, 3]' , [ 1, 1, 3]' ];
faces(9,:,:)  = [[ 3, 3, 3]' , [ 3, 1, 3]' , [ 1, 1, 3]' , [ 1, 3, 3]' ];

% Groups of verteces of orange (L) face

faces(10,:,:) = [[-3,-3, 3]' , [-1,-3, 3]' , [-1,-3, 1]' , [-3,-3, 1]' ];
faces(11,:,:) = [[-1,-3, 3]' , [ 1,-3, 3]' , [ 1,-3, 1]' , [-1,-3, 1]' ];
faces(12,:,:) = [[ 1,-3, 3]' , [ 3,-3, 3]' , [ 3,-3, 1]' , [ 1,-3, 1]' ];

faces(22,:,:) = [[-3,-3, 1]' , [-1,-3, 1]' , [-1,-3,-1]' , [-3,-3,-1]' ];
faces(23,:,:) = [[ 1,-3, 1]' , [ 1,-3,-1]' , [-1,-3,-1]' , [-1,-3, 1]' ];
faces(24,:,:) = [[ 1,-3, 1]' , [ 3,-3, 1]' , [ 3,-3,-1]' , [ 1,-3,-1]' ];

faces(34,:,:) = [[-3,-3,-1]' , [-1,-3,-1]' , [-1,-3,-3]' , [-3,-3,-3]' ];
faces(35,:,:) = [[-1,-3,-1]' , [ 1,-3,-1]' , [ 1,-3,-3]' , [-1,-3,-3]' ];
faces(36,:,:) = [[ 1,-3,-1]' , [ 3,-3,-1]' , [ 3,-3,-3]' , [ 1,-3,-3]' ];

% Groups of verteces of green (F) face

faces(13,:,:) = [[ 3,-3, 3]' , [ 3,-1, 3]' , [ 3,-1, 1]' , [ 3,-3, 1]' ];
faces(14,:,:) = [[ 3,-1, 1]' , [ 3,-1, 3]' , [ 3, 1, 3]' , [ 3, 1, 1]' ];
faces(15,:,:) = [[ 3, 3, 3]' , [ 3, 1, 3]' , [ 3, 1, 1]' , [ 3, 3, 1]' ];

faces(25,:,:) = [[ 3,-3, 1]' , [ 3,-1, 1]' , [ 3,-1,-1]' , [ 3,-3,-1]' ];
faces(26,:,:) = [[ 3,-1,-1]' , [ 3,-1, 1]' , [ 3, 1, 1]' , [ 3, 1,-1]' ];
faces(27,:,:) = [[ 3, 3,-1]' , [ 3, 1,-1]' , [ 3, 1, 1]' , [ 3, 3, 1]' ];

faces(37,:,:) = [[ 3,-3,-1]' , [ 3,-1,-1]' , [ 3,-1,-3]' , [ 3,-3,-3]' ];
faces(38,:,:) = [[ 3, 1,-1]' , [ 3,-1,-1]' , [ 3,-1,-3]' , [ 3, 1,-3]' ];
faces(39,:,:) = [[ 3, 3,-1]' , [ 3, 1,-1]' , [ 3, 1,-3]' , [ 3, 3,-3]' ];

% Groups of verteces of red (R) face

faces(16,:,:) = [[ 1, 3, 3]' , [ 3, 3, 3]' , [ 3, 3, 1]' , [ 1, 3, 1]' ];
faces(17,:,:) = [[-1, 3, 3]' , [ 1, 3, 3]' , [ 1, 3, 1]' , [-1, 3, 1]' ];
faces(18,:,:) = [[-3, 3, 3]' , [-1, 3, 3]' , [-1, 3, 1]' , [-3, 3, 1]' ];

faces(28,:,:) = [[ 1, 3, 1]' , [ 3, 3, 1]' , [ 3, 3,-1]' , [ 1, 3,-1]' ];
faces(29,:,:) = [[ 1, 3, 1]' , [ 1, 3,-1]' , [-1, 3,-1]' , [-1, 3, 1]' ];
faces(30,:,:) = [[-3, 3, 1]' , [-1, 3, 1]' , [-1, 3,-1]' , [-3, 3,-1]' ];

faces(40,:,:) = [[ 1, 3,-1]' , [ 3, 3,-1]' , [ 3, 3,-3]' , [ 1, 3,-3]' ];
faces(41,:,:) = [[-1, 3,-1]' , [ 1, 3,-1]' , [ 1, 3,-3]' , [-1, 3,-3]' ];
faces(42,:,:) = [[-3, 3,-1]' , [-1, 3,-1]' , [-1, 3,-3]' , [-3, 3,-3]' ];

% Groups of verteces of blue (B) face

faces(19,:,:) = [[-3, 3, 3]' , [-3, 1, 3]' , [-3, 1, 1]' , [-3, 3, 1]' ];
faces(20,:,:) = [[-3,-1, 1]' , [-3,-1, 3]' , [-3, 1, 3]' , [-3, 1, 1]' ];
faces(21,:,:) = [[-3,-3, 3]' , [-3,-1, 3]' , [-3,-1, 1]' , [-3,-3, 1]' ];

faces(31,:,:) = [[-3, 3,-1]' , [-3, 1,-1]' , [-3, 1, 1]' , [-3, 3, 1]' ];
faces(32,:,:) = [[-3,-1,-1]' , [-3,-1, 1]' , [-3, 1, 1]' , [-3, 1,-1]' ];
faces(33,:,:) = [[-3,-3, 1]' , [-3,-1, 1]' , [-3,-1,-1]' , [-3,-3,-1]' ];

faces(43,:,:) = [[-3, 3,-1]' , [-3, 1,-1]' , [-3, 1,-3]' , [-3, 3,-3]' ];
faces(44,:,:) = [[-3, 1,-1]' , [-3,-1,-1]' , [-3,-1,-3]' , [-3, 1,-3]' ];
faces(45,:,:) = [[-3,-3,-1]' , [-3,-1,-1]' , [-3,-1,-3]' , [-3,-3,-3]' ];

% Groups of verteces of yellow (D) face

faces(46,:,:) = [[ 3,-3,-3]' , [ 3,-1,-3]' , [ 1,-1,-3]', [ 1,-3,-3]' ];
faces(47,:,:) = [[ 1,-1,-3]' , [ 3,-1,-3]' , [ 3, 1,-3]' , [ 1, 1,-3]' ];
faces(48,:,:) = [[ 3, 3,-3]' , [ 3, 1,-3]' , [ 1, 1,-3]' , [ 1, 3,-3]' ];

faces(49,:,:) = [[ 1,-3,-3]' , [ 1,-1,-3]' , [-1,-1,-3]' , [-1,-3,-3]' ];
faces(50,:,:) = [[-1,-1,-3]' , [ 1,-1,-3]' , [ 1, 1,-3]' , [-1, 1,-3]' ];
faces(51,:,:) = [[-1, 3,-3]' , [-1, 1,-3]' , [ 1, 1,-3]' , [ 1, 3,-3]' ];

faces(52,:,:) = [[-1,-3,-3]' , [-1,-1,-3]' , [-3,-1,-3]' , [-3,-3,-3]' ];
faces(53,:,:) = [[-1, 1,-3]' , [-1,-1,-3]' , [-3,-1,-3]' , [-3, 1,-3]' ];
faces(54,:,:) = [[-1, 3,-3]' , [-1, 1,-3]' , [-3, 1,-3]' , [-3, 3,-3]' ];

% Black faces from F to B

scal = 1;
faces(101,:,:) = [[ 1, 3, 3]' , [ 1, 1, 3]' , [ 1, 1, 1]' , [ 1, 3, 1]' ];
faces(102,:,:) = [[ 1, 1,-1]' , [ 1, 3,-1]' , [ 1, 3,-3]' , [ 1, 1,-3]' ];
faces(103,:,:) = [[ 1,-3,-1]' , [ 1,-1,-1]' , [ 1,-1,-3]' , [ 1,-3,-3]' ];
faces(104,:,:) = [[ 1,-3, 3]' , [ 1,-1, 3]' , [ 1,-1, 1]' , [ 1,-3, 1]' ];

faces(105,:,:) = scal*[[ 1, 3, 3]' , [ 1, 3,-3]' , [ 1,-3,-3]' , [ 1,-3, 3]' ];

faces(106,:,:) = scal*[[-1, 3, 3]' , [-1, 3,-3]' , [-1,-3,-3]' , [-1,-3, 3]' ];

faces(107,:,:) = [[-1, 3, 3]' , [-1, 1, 3]' , [-1, 1, 1]' , [-1, 3, 1]' ];
faces(108,:,:) = [[-1, 1,-1]' , [-1, 3,-1]' , [-1, 3,-3]' , [-1, 1,-3]' ];
faces(109,:,:) = [[-1,-3,-1]' , [-1,-1,-1]' , [-1,-1,-3]' , [-1,-3,-3]' ];
faces(110,:,:) = [[-1,-3, 3]' , [-1,-1, 3]' , [-1,-1, 1]' , [-1,-3, 1]' ];

% Black faces from R to L

faces(111,:,:) = [[ 3, 1, 3]' , [ 1, 1, 3]' , [ 1, 1, 1]' , [ 3, 1, 1]' ];
faces(112,:,:) = [[ 1, 1,-1]' , [ 3, 1,-1]' , [ 3, 1,-3]' , [ 1, 1,-3]' ];
faces(113,:,:) = [[-3, 1,-1]' , [-1, 1,-1]' , [-1, 1,-3]' , [-3, 1,-3]' ];
faces(114,:,:) = [[-3, 1, 3]' , [-1, 1, 3]' , [-1, 1, 1]' , [-3, 1, 1]' ];

faces(115,:,:) = scal*[[ 3, 1, 3]' , [ 3, 1,-3]' , [-3, 1,-3]' , [-3, 1, 3]' ];

faces(116,:,:) = scal*[[ 3,-1, 3]' , [ 3,-1,-3]' , [-3,-1,-3]' , [-3,-1, 3]' ];

faces(117,:,:) = [[ 3,-1, 3]' , [ 1,-1, 3]' , [ 1,-1, 1]' , [ 3,-1, 1]' ];
faces(118,:,:) = [[ 1,-1,-1]' , [ 3,-1,-1]' , [ 3,-1,-3]' , [ 1,-1,-3]' ];
faces(119,:,:) = [[-3,-1,-1]' , [-1,-1,-1]' , [-1,-1,-3]' , [-3,-1,-3]' ];
faces(120,:,:) = [[-3,-1, 3]' , [-1,-1, 3]' , [-1,-1, 1]' , [-3,-1, 1]' ];

% Black faces from U to D

faces(121,:,:) = [[ 3, 3, 1]' , [ 1, 3, 1]' , [ 1, 1, 1]' , [ 3, 1, 1]' ];
faces(122,:,:) = [[ 1,-1, 1]' , [ 3,-1, 1]' , [ 3,-3, 1]' , [ 1,-3, 1]' ];
faces(123,:,:) = [[-3,-1, 1]' , [-1,-1, 1]' , [-1,-3, 1]' , [-3,-3, 1]' ];
faces(124,:,:) = [[-3, 3, 1]' , [-1, 3, 1]' , [-1, 1, 1]' , [-3, 1, 1]' ];

faces(125,:,:) = scal*[[ 3, 3, 1]' , [ 3,-3, 1]' , [-3,-3, 1]' , [-3, 3, 1]' ];

faces(126,:,:) = scal*[[ 3, 3,-1]' , [ 3,-3,-1]' , [-3,-3,-1]' , [-3, 3,-1]' ];

faces(127,:,:) = [[ 3, 3,-1]' , [ 1, 3,-1]' , [ 1, 1,-1]' , [ 3, 1,-1]' ];
faces(128,:,:) = [[ 1,-1,-1]' , [ 3,-1,-1]' , [ 3,-3,-1]' , [ 1,-3,-1]' ];
faces(129,:,:) = [[-3,-1,-1]' , [-1,-1,-1]' , [-1,-3,-1]' , [-3,-3,-1]' ];
faces(130,:,:) = [[-3, 3,-1]' , [-1, 3,-1]' , [-1, 1,-1]' , [-3, 1,-1]' ];

end

% Define the coordinates of the faces in 2D
function faces = define_faces_2d()

% Vertices coordinates

v1  = [ 6, 18]';
v2  = [ 8, 18]';
v3  = [10, 18]';
v4  = [12, 18]';

v5  = [ 6, 16]';
v6  = [ 8, 16]';
v7  = [10, 16]';
v8  = [12, 16]';

v9  = [ 6, 14]';
v10 = [ 8, 14]';
v11 = [10, 14]';
v12 = [12, 14]';

v13 = [ 0, 12]';
v14 = [ 2, 12]';
v15 = [ 4, 12]';
v16 = [ 6, 12]';
v17 = [ 8, 12]';
v18 = [10, 12]';
v19 = [12, 12]';
v20 = [14, 12]';
v21 = [16, 12]';
v22 = [18, 12]';
v23 = [20, 12]';
v24 = [22, 12]';
v25 = [24, 12]';

v26 = [ 0, 10]';
v27 = [ 2, 10]';
v28 = [ 4, 10]';
v29 = [ 6, 10]';
v30 = [ 8, 10]';
v31 = [10, 10]';
v32 = [12, 10]';
v33 = [14, 10]';
v34 = [16, 10]';
v35 = [18, 10]';
v36 = [20, 10]';
v37 = [22, 10]';
v38 = [24, 10]';

v39 = [ 0,  8]';
v40 = [ 2,  8]';
v41 = [ 4,  8]';
v42 = [ 6,  8]';
v43 = [ 8,  8]';
v44 = [10,  8]';
v45 = [12,  8]';
v46 = [14,  8]';
v47 = [16,  8]';
v48 = [18,  8]';
v49 = [20,  8]';
v50 = [22,  8]';
v51 = [24,  8]';

v52 = [ 0,  6]';
v53 = [ 2,  6]';
v54 = [ 4,  6]';
v55 = [ 6,  6]';
v56 = [ 8,  6]';
v57 = [10,  6]';
v58 = [12,  6]';
v59 = [14,  6]';
v60 = [16,  6]';
v61 = [18,  6]';
v62 = [20,  6]';
v63 = [22,  6]';
v64 = [24,  6]';

v65 = [ 6,  4]';
v66 = [ 8,  4]';
v67 = [10,  4]';
v68 = [12,  4]';

v69 = [ 6,  2]';
v70 = [ 8,  2]';
v71 = [10,  2]';
v72 = [12,  2]';

v73 = [ 6,  0]';
v74 = [ 8,  0]';
v75 = [10,  0]';
v76 = [12,  0]';

% Faces coordinates

faces = NaN(2,4,54);

% Groups of vertices of white (U) face

faces(:,:,1)  = [ v1,  v2,  v6,  v5];
faces(:,:,2)  = [ v2,  v3,  v7,  v6];
faces(:,:,3)  = [ v3,  v4,  v8,  v7];

faces(:,:,4)  = [ v5,  v6, v10,  v9];
faces(:,:,5)  = [ v6,  v7, v12, v10];
faces(:,:,6)  = [ v7,  v8, v12, v11];

faces(:,:,7)  = [ v9, v10, v17, v16];
faces(:,:,8)  = [v10, v11, v18, v17];
faces(:,:,9)  = [v11, v12, v19, v18];

% Groups of vertices of orange (L) face

faces(:,:,10) = [v13, v14, v27, v26];
faces(:,:,11) = [v14, v15, v28, v27];
faces(:,:,12) = [v15, v16, v29, v28];

faces(:,:,22) = [v26, v27, v40, v39];
faces(:,:,23) = [v27, v28, v41, v40];
faces(:,:,24) = [v28, v29, v42, v41];

faces(:,:,34) = [v39, v40, v53, v52];
faces(:,:,35) = [v40, v41, v54, v53];
faces(:,:,36) = [v41, v42, v55, v54];

% Groups of vertices of green (F) face

faces(:,:,13) = [v16, v17, v30, v29];
faces(:,:,14) = [v17, v18, v31, v30];
faces(:,:,15) = [v18, v19, v32, v31];

faces(:,:,25) = [v29, v30, v43, v42];
faces(:,:,26) = [v30, v31, v44, v43];
faces(:,:,27) = [v31, v32, v45, v44];

faces(:,:,37) = [v42, v43, v56, v55];
faces(:,:,38) = [v43, v44, v57, v56];
faces(:,:,39) = [v44, v46, v58, v57];

% Groups of vertices of red (R) face

faces(:,:,16) = [v19, v20, v33, v32];
faces(:,:,17) = [v20, v21, v34, v33];
faces(:,:,18) = [v21, v22, v35, v34];

faces(:,:,28) = [v32, v33, v46, v45];
faces(:,:,29) = [v33, v34, v47, v46];
faces(:,:,30) = [v34, v35, v48, v47];

faces(:,:,40) = [v45, v46, v59, v58];
faces(:,:,41) = [v46, v47, v60, v59];
faces(:,:,42) = [v47, v48, v61, v60];

% Groups of vertices of blue (B) face

faces(:,:,19) = [v22, v23, v36, v35];
faces(:,:,20) = [v23, v24, v37, v36];
faces(:,:,21) = [v24, v25, v38, v37];

faces(:,:,31) = [v35, v36, v49, v48];
faces(:,:,32) = [v36, v37, v50, v49];
faces(:,:,33) = [v37, v38, v51, v50];

faces(:,:,43) = [v48, v49, v62, v61];
faces(:,:,44) = [v49, v50, v63, v62];
faces(:,:,45) = [v50, v51, v64, v63];

% Groups of vertices of yellow (D) face

faces(:,:,46) = [v55, v56, v66, v65];
faces(:,:,47) = [v56, v57, v67, v66];
faces(:,:,48) = [v57, v58, v68, v67];

faces(:,:,49) = [v65, v66, v70, v69];
faces(:,:,50) = [v66, v67, v71, v70];
faces(:,:,51) = [v67, v68, v72, v71];

faces(:,:,52) = [v69, v70, v74, v73];
faces(:,:,53) = [v70, v71, v75, v74];
faces(:,:,54) = [v71, v72, v76, v75];

end

% Color map: from number (state) to color
function colors = color_map()

o = [0.970, 0.730, 0.250];
colors = {'w','w','w','w','w','w','w','w','w',...
    o , o , o ,'g','g','g','r','r','r','b','b','b',...
    o , o , o ,'g','g','g','r','r','r','b','b','b',...
    o , o , o ,'g','g','g','r','r','r','b','b','b',...
    'y','y','y','y','y','y','y','y','y'};

end